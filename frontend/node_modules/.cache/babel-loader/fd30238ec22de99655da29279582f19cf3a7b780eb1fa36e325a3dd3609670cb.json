{"ast":null,"code":"import{createAsyncThunk,createSlice}from'@reduxjs/toolkit';import{getAlbums,getAlbumDetails,createAlbum,updateAlbum,updateInventory,searchAlbums,getTopSellingAlbums}from'../services/albumService';export const fetchAlbums=createAsyncThunk('albums/fetchAll',async function(){let page=arguments.length>0&&arguments[0]!==undefined?arguments[0]:1;return await getAlbums(page);});export const fetchAlbumDetails=createAsyncThunk('albums/fetchDetails',async id=>{return await getAlbumDetails(id);});export const addNewAlbum=createAsyncThunk('albums/addNew',async albumData=>{return await createAlbum(albumData);});export const modifyAlbum=createAsyncThunk('albums/update',async _ref=>{let{id,data}=_ref;return await updateAlbum(id,data);});export const modifyInventory=createAsyncThunk('albums/updateInventory',async _ref2=>{let{id,data}=_ref2;return await updateInventory(id,data);});export const searchAlbumCatalog=createAsyncThunk('albums/search',async query=>{return await searchAlbums(query);});export const fetchTopSellingAlbums=createAsyncThunk('albums/fetchTopSelling',async()=>{return await getTopSellingAlbums();});const albumSlice=createSlice({name:'albums',initialState:{list:[],currentAlbum:null,searchResults:[],topSelling:[],status:'idle',error:null,pagination:{}},reducers:{clearCurrentAlbum:state=>{state.currentAlbum=null;},clearSearchResults:state=>{state.searchResults=[];}},extraReducers:builder=>{builder.addCase(fetchAlbums.pending,state=>{state.status='loading';}).addCase(fetchAlbums.fulfilled,(state,action)=>{state.status='succeeded';state.list=action.payload.data||[];state.pagination=action.payload.pagination||{};}).addCase(fetchAlbums.rejected,(state,action)=>{state.status='failed';state.error=action.error.message;}).addCase(fetchAlbumDetails.pending,state=>{state.status='loading';}).addCase(fetchAlbumDetails.fulfilled,(state,action)=>{state.status='succeeded';state.currentAlbum=action.payload;}).addCase(fetchAlbumDetails.rejected,(state,action)=>{state.status='failed';state.error=action.error.message;}).addCase(addNewAlbum.fulfilled,(state,action)=>{state.list=[...state.list,action.payload];}).addCase(modifyAlbum.fulfilled,(state,action)=>{var _state$currentAlbum;state.status='succeeded';const index=state.list.findIndex(a=>a.id===action.payload.id);if(index!==-1){state.list[index]=action.payload;}if(((_state$currentAlbum=state.currentAlbum)===null||_state$currentAlbum===void 0?void 0:_state$currentAlbum.id)===action.payload.id){state.currentAlbum=action.payload;}}).addCase(modifyInventory.fulfilled,(state,action)=>{state.status='succeeded';if(state.currentAlbum){state.currentAlbum.inventories=[action.payload];}const albumIndex=state.list.findIndex(a=>{var _a$inventories;return(_a$inventories=a.inventories)===null||_a$inventories===void 0?void 0:_a$inventories.some(i=>i.id===action.payload.id);});if(albumIndex!==-1){state.list[albumIndex].inventories=[action.payload];}}).addCase(searchAlbumCatalog.pending,state=>{state.status='loading';}).addCase(searchAlbumCatalog.fulfilled,(state,action)=>{state.status='succeeded';state.searchResults=action.payload;}).addCase(searchAlbumCatalog.rejected,(state,action)=>{state.status='failed';state.error=action.error.message;}).addCase(fetchTopSellingAlbums.pending,state=>{state.status='loading';}).addCase(fetchTopSellingAlbums.fulfilled,(state,action)=>{state.status='succeeded';state.topSelling=action.payload.map(item=>({id:item.id,albumTitle:item.title,catalogNumber:item.catalogNumber,ensembleName:item.ensemble,currentYearSales:item.sales,retailPrice:item.retailPrice,unsold:item.unsold}));}).addCase(fetchTopSellingAlbums.rejected,(state,action)=>{state.status='failed';state.error=action.error.message;});}});export const{clearCurrentAlbum,clearSearchResults}=albumSlice.actions;export default albumSlice.reducer;","map":{"version":3,"names":["createAsyncThunk","createSlice","getAlbums","getAlbumDetails","createAlbum","updateAlbum","updateInventory","searchAlbums","getTopSellingAlbums","fetchAlbums","page","arguments","length","undefined","fetchAlbumDetails","id","addNewAlbum","albumData","modifyAlbum","_ref","data","modifyInventory","_ref2","searchAlbumCatalog","query","fetchTopSellingAlbums","albumSlice","name","initialState","list","currentAlbum","searchResults","topSelling","status","error","pagination","reducers","clearCurrentAlbum","state","clearSearchResults","extraReducers","builder","addCase","pending","fulfilled","action","payload","rejected","message","_state$currentAlbum","index","findIndex","a","inventories","albumIndex","_a$inventories","some","i","map","item","albumTitle","title","catalogNumber","ensembleName","ensemble","currentYearSales","sales","retailPrice","unsold","actions","reducer"],"sources":["/Users/mak/musicShop/frontend/src/features/albumSlice.js"],"sourcesContent":["import { createAsyncThunk, createSlice } from '@reduxjs/toolkit';\nimport { \n  getAlbums, \n  getAlbumDetails, \n  createAlbum, \n  updateAlbum,\n  updateInventory,\n  searchAlbums,\n  getTopSellingAlbums\n} from '../services/albumService';\n\nexport const fetchAlbums = createAsyncThunk(\n  'albums/fetchAll',\n  async (page = 1) => {\n    return await getAlbums(page);\n  }\n);\n\nexport const fetchAlbumDetails = createAsyncThunk(\n  'albums/fetchDetails',\n  async (id) => {\n    return await getAlbumDetails(id);\n  }\n);\n\nexport const addNewAlbum = createAsyncThunk(\n  'albums/addNew',\n  async (albumData) => {\n    return await createAlbum(albumData);\n  }\n);\n\nexport const modifyAlbum = createAsyncThunk(\n  'albums/update',\n  async ({ id, data }) => {\n    return await updateAlbum(id, data);\n  }\n);\n\nexport const modifyInventory = createAsyncThunk(\n  'albums/updateInventory',\n  async ({ id, data }) => {\n    return await updateInventory(id, data);\n  }\n);\n\nexport const searchAlbumCatalog = createAsyncThunk(\n  'albums/search',\n  async (query) => {\n    return await searchAlbums(query);\n  }\n);\n\nexport const fetchTopSellingAlbums = createAsyncThunk(\n  'albums/fetchTopSelling',\n  async () => {\n    return await getTopSellingAlbums();\n  }\n);\n\nconst albumSlice = createSlice({\n  name: 'albums',\n  initialState: {\n    list: [],\n    currentAlbum: null,\n    searchResults: [],\n    topSelling: [],\n    status: 'idle',\n    error: null,\n    pagination: {}\n  },\n  reducers: {\n    clearCurrentAlbum: (state) => {\n      state.currentAlbum = null;\n    },\n    clearSearchResults: (state) => {\n      state.searchResults = [];\n    }\n  },\n  extraReducers: (builder) => {\n    builder\n      .addCase(fetchAlbums.pending, (state) => {\n        state.status = 'loading';\n      })\n      .addCase(fetchAlbums.fulfilled, (state, action) => {\n        state.status = 'succeeded';\n        state.list = action.payload.data || [];\n        state.pagination = action.payload.pagination || {};\n      })\n      .addCase(fetchAlbums.rejected, (state, action) => {\n        state.status = 'failed';\n        state.error = action.error.message;\n      })\n      .addCase(fetchAlbumDetails.pending, (state) => {\n        state.status = 'loading';\n      })\n      .addCase(fetchAlbumDetails.fulfilled, (state, action) => {\n        state.status = 'succeeded';\n        state.currentAlbum = action.payload;\n      })\n      .addCase(fetchAlbumDetails.rejected, (state, action) => {\n        state.status = 'failed';\n        state.error = action.error.message;\n      })\n      .addCase(addNewAlbum.fulfilled, (state, action) => {\n        state.list = [...state.list, action.payload];\n      })\n      .addCase(modifyAlbum.fulfilled, (state, action) => {\n        state.status = 'succeeded';\n        const index = state.list.findIndex(a => a.id === action.payload.id);\n        if (index !== -1) {\n          state.list[index] = action.payload;\n        }\n        if (state.currentAlbum?.id === action.payload.id) {\n          state.currentAlbum = action.payload;\n        }\n      })\n      .addCase(modifyInventory.fulfilled, (state, action) => {\n        state.status = 'succeeded';\n        if (state.currentAlbum) {\n          state.currentAlbum.inventories = [action.payload];\n        }\n        const albumIndex = state.list.findIndex(a => \n          a.inventories?.some(i => i.id === action.payload.id)\n        );\n        if (albumIndex !== -1) {\n          state.list[albumIndex].inventories = [action.payload];\n        }\n      })\n      .addCase(searchAlbumCatalog.pending, (state) => {\n        state.status = 'loading';\n      })\n      .addCase(searchAlbumCatalog.fulfilled, (state, action) => {\n        state.status = 'succeeded';\n        state.searchResults = action.payload;\n      })\n      .addCase(searchAlbumCatalog.rejected, (state, action) => {\n        state.status = 'failed';\n        state.error = action.error.message;\n      })\n      .addCase(fetchTopSellingAlbums.pending, (state) => {\n        state.status = 'loading';\n      })\n      .addCase(fetchTopSellingAlbums.fulfilled, (state, action) => {\n        state.status = 'succeeded';\n        state.topSelling = action.payload.map(item => ({\n          id: item.id,\n          albumTitle: item.title,\n          catalogNumber: item.catalogNumber,\n          ensembleName: item.ensemble,\n          currentYearSales: item.sales,\n          retailPrice: item.retailPrice,\n          unsold: item.unsold\n        }));\n      })\n      .addCase(fetchTopSellingAlbums.rejected, (state, action) => {\n        state.status = 'failed';\n        state.error = action.error.message;\n      });\n  }\n});\n\nexport const { clearCurrentAlbum, clearSearchResults } = albumSlice.actions;\nexport default albumSlice.reducer;"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}